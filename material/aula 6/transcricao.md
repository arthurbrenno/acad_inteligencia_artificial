Tischel, peguei wraith. Peguei wraith, ciao. – Começa. – Está fechada agora. – Yummy! Olha a começar, olha a começar. – Chega mano. Chega. Chega! Chega! Vamos. Chega! Chega! Vem aqui. – Eu não posso, cara, eu não tenho como é que é isso. – Tá vendo, eu nem achou nada. – Não, não, não, é sincero, ele precisa de perguntar. – Não, não, precisa de perguntar. – Ah, 50 reais é 50 reais, né? – Olha lá, passa aí o máximo. – Não, não, não, não, não, não, não, não. – Não, ele tá me falando que o treino vale muito mais que 50 reais. Ele tá falando que passa inteligente, que a gente não precisa fazer nada. – Não, não, não, não, não, não, não, não, não, não, não, não, não, não, não, não. – Agora entendi. – Eu acabei precisando de três beijos nessa ditade. – Ah, vai, vai. Vai ser 40 segundos de felicidade pra ele. – Vai. – É que é desgosto. – Ah, o cara tá fazendo coisa de gente. – Vamos lá. Pessoal. Como que é que o pessoal dá? – Sei lá, você desenha um pentagrama. – Hã? – Você desenha um pentagrama. – Pentagrama. O que o senhor tem que estar fazendo hoje? Não dá pra fazer sozinho, tá? Ó, tem a minha sequência, correto? Mesmo que a gente fez a passada, a gente ignorou só aqui. – Sim. – Certo? Essa já não é uma pirmada de pillar. Uma pirmada de pillar é só isso. A gente desaja profundo, tá? O treinamento dela tem que ser mais baixo, tá? Pra eu trazer você no ponto um, tá bem baixinho o treinamento. – Tá baixinho. – Vamos, vamos. Entendeu? Tá? Tem que ser bem baixo o treinamento. Como é que vai funcionar? Vamos fazer aqui no quadro, ó. A entrada aqui vai ficar assim, ó. Menos um, X1 e X2, correto? Vai ficar A, B, C, D, E e F. Porque são dois diamantes, correto? Então vai fazer certo esse vez esse, mais esse vez esse, mais esse vez esse, mais esse vez esse, tal, tal, tal. Vai te dar a saída aqui, funcionalidade, essa primeira camada aqui, de Y0, Y01 e Y02, correto? Quando vir pra outra camada, o que você vai fazer? Você vai passar pela função de ativação, óbvio, né? Que vai ser a logística. Certo? Essa é a logística. Na última camada, você vai adicionar um menos um, vai adicionar um bias, tá? Colocar Y01, Y02 e fazemos, fazemos de novo. Vai ficar o quê? G, H, I, J, F, I. Botei o cara aqui não, tá? Beleza? Esse vez esse, esse vez esse, esse vez esse, tal, vai sair o quê? Y1, 1, Y1, 2, certo? E na última camada, nós vamos ficar o quê? Menos um, Y01, Y02, né? E vamos ficar pelo quê? Por N, O e T e dar resultado apenas no YS, que é o de saída, correto? Beleza? Então a gente fez o quê? O feed-forward. Vou pra frente. Solta, querido. Bom, vendo isso, tem que fazer o quê? Fazer o back-propagation, correto? O back-propagation tem que fazer, calcular o delta, não é isso? O que é o delta? É o target menos seu nosso ambiente. Ou, no caso, o nosso aqui é o YS, correto? Não se esqueçam que vocês têm que calcular para todas as saídas aqui, no caso essa aqui, não, essa saída, essa e essa, e calcular as derivadas dela, correto? Já calculou? Já calculou a linha. A derivada vai ser o quê? Para esse caso, 1 menos Y, 0, 1 derivada. Y, 0, 1 derivada. Vai ser o quê? Y, 0, 1, desculpa, menos Y, 0, 1, que multiplica 1 menos Y, 0, 1. É isso? É isso ou não? Lembra disso? Você quer a derivada da função, certo? Então acontece, se for 0, dá 0, se for 1, dá 0, é aquela faixa. Então essa aqui é a minha variação, para todos esses que você fazer. Então eu preciso da derivada de todos. Acabou de fazer, aí você tem que fazer, tem que fazer a propagação aqui para trás. Por que tem que propagar? Tem que propagar o delta. Como é que você vai propagar o delta? Esse primeiro delta que é calculado, ele corrige quem? Ele corrige o peso O, N, O, P, o O e o P. Ele corrige esses aqui. O delta próximo, pode falar de delta 1, ou seja, o que ele vai corrigir dentro do delta 1? É o delta 0 multiplicado por quê? Pelo O e pelo P, correto? Então vai dar aqui, vai dar delta, deixa eu chamar de delta O e de delta P. Esses dois aqui, o delta O corrige o GH e o I, e o delta P corrige e isso aí. Beleza? E agora o próximo, é um pouquinho mais complicado esse aqui. Vou ter que fazer uma jogada de matriz. Por quê? Você está vendo que esse cara aqui recebe tanto do O quanto do P? Certo ou não? O que você vai fazer? Você vai fazer isso aqui. Você vai pegar o seu delta O e o delta P e vai multiplicar pela transposta da matriz, dessa matriz aqui. Você vai pegar só isso aqui dessa matriz. Essa transposta dela vai ficar assim. B, C, F, E e F. Essa é a transposta. Por que você fez isso? Se eu pegar aqui, não peguei errado, é esse cara aqui, H, M e E. Isso. Se eu for pegar aqui, esse cara aqui recebe quem? Ele recebe o H e o E, não é isso? Certo? E esse cara recebe quem? O E e o E. Por isso eu pego só esse cara aqui. Não se esquece disso. Se eu for fazer S vezes S, mais S vezes S, tem que dar certinho. Delta O vezes H, delta P vezes M e delta P vezes N. S vezes S, mais S vezes S. Não se esquece do meu Y ou 1. Aqui meu delta, H, M e meu delta e N. Esses dois caras aqui, o que corrigem? Esse primeiro vai corrigir o A, o B e o C e o outro vai corrigir D, E e F. Tá? Show? Acabou de fazer isso aqui. Vocês vão fazer o que? Vai aplicar aqui na aprendizagem. Acabou não. Acabou. Vezes a derivada da função, vezes o delta, vezes o X, N. Quem quer fazer chamada? Quem quer fazer chamada? Vou fazer pra vocês, vai. Esse vai ser a última gente nova que vai ensinar pra vocês. Depois eu vou começar com o genérico, tá? Essa vai ser a última gente nova que eu vou passar. Se eu passar as outras, eu acho que não tem problema. E a primeira que você passou, a gente tá dando conta de fazer sozinho? Mas demora quanto tempo pra fazer sozinho uma dessas? Eu aprendi na faculdade, conheci. Mas você demorou até 15 minutos pra fazer sozinho uma dozela? Foi mesmo uma semana. Depois de quanto tempo? Uma semana foi. Você aprendeu ela? A que eu demorei mais a aprender, que foi dois meses, foi aquela que é a mesma usada no XSPT. Que é a rede neurorrecorrente. Essa eu não vou passar não. Dificilmente. Eu faço imagens. Eu passei só uma vez lá. Até hoje aqui na faculdade. Depois você tem que ensinar como é que faz a criação das bibliotecas do saco de palavras. Porque esse é o que vai pegar. Vamos ver. Mesmo que não vá ser utilizado. Essa vai ser a última. Vamos lá. Essa você vai ter que reproduzir em casa, né? Não, eu vou passar pra vocês. Vamos lá, pessoal. Vou fazer igual os caras no quadro. Vamos lá. Cria SLC, correto? Calma. Eu vou fazer aqui, pessoal. A porta lógica é a Indy, certo? Eu vou ficar lá. Tá. Acabou. É o XSPT. Não, não é. Hã? Não, não é. Só passa o quadro. Por exemplo. Aqui é o CC do país. É. Não precisa. Não. Hã? Tá bom, obrigado. Vamos lá. Eu criei os dados aqui. O que é que eu preciso aqui, pessoal? Nessa rede, eu tenho que falar pra ele quantas palavras eu vou ter na camada de entrada e quantas palavras eu vou ter na camada de entrada nas intermediárias, correto? Quantas entradas que eu tenho? No caso aqui são três, correto? Três entradas. Número de neurônio da primeira camada. Vão ser dois. Da segunda camada. Dois. Número de amostras. Dois. Dois. Dois. Dois. Dados. Vai ser um, correto? Aqui é a entrada. Pegar as linhas dela. N-0-1. Já vou começar depois de encher a aumento, se precisar. É a taxa. Que mais eu pego aqui? A taxa de aprendizado baixa, assim, é pra acontecer o quê? Ela perde o computador. Ou vai pro final, ela perde o computador. Nesse caso, desce no específico, né? Quanto mais profundo a rede, menor é a taxa. Se não, ele vai me pular. Se der errado aqui, eu vou mudar a futura ativação ainda. Então, o que eu vou fazer? Beleza. A primeira coisa é montar os pesos. Então, vamos botar aqui o peso da camada 1, W1. Se ela vai demorar mais tempo pra aprender, então ela vai demorar mais tempo pra dar a resposta pra mim? Não, pra aprender só. Pra resposta, não. Quanto mais neurônio, mais ela demora. É, claramente. Então, vou lá. Sempre a linha vai ser a quantidade de entrada que eu tenho, correto? NE. E o J vai ser o número de neurônio. No caso, como vai ser o primeiro neurônio, é o N1, correto? N1, certo? RANGE. W1. E J. Será igual a RANGE. Eu tenho que fazer isso pro W1, né? Isso aqui. Eu tenho que fazer isso pro W1, né? Esse cara aqui vai ser o W1. O W2 e tem o W3 ainda, certo? W3 também é igual. Ó, pra você. W2, ó. Tem que tomar cuidado agora, por quê? O W2 vai ser o número que eu tenho de neurônio na camada 1, mais 1, correto? Que é o BIAS. Certo? Ou não? Por quê? Esse neurônio vai ter o quê? Dois entradas, certo? Mais um do BIAS. Certo? Mais um do BIAS. E o número de neurônio vai ser o N2. Tá lá, ó. Eu desenho, pessoal, assim pra quê? Pra ficar mais fácil. Você vai seguindo o desenho. Eu sou da época em que tudo que a gente fazia, a gente desenhava. Até fazer código, sempre desenhei, a vida inteira. Sempre montei fluxograma. O pessoal hoje é muito melhor que eu. Isso aí é gilete de cabeça. Os caras são violentos, né? Mas eu tenho essa dificuldade. Eu desenho e risco pro meio dele. Depois eu faço a programação. Vamos lá, ó. O que vai ser as minhas entradas do meu FOR? Vai ser o número, ó. Vai ser igual o que eu tenho de neurônio na camada 2, mais um do BIAS, correto? Não vou precisar de J, porque esse eu tenho de neurônio. Então, meu W3 vai ser o quê? Só o I e o AND. Só isso, ó. Montei as três sequências. Vou mandar rodar, ó. Então, W1, beleza? Dois neurônios e três entradas. W2. Que difícil o W2, né? W1, W2 e W3, ó. Certinho, ó. É dois neurônios, dois neurônios e um neurônio, tá? Cada um com três entradas, certo? Se eu alterar alguma coisa aqui, já ajusta pra mim, beleza. O que eu vou fazer agora? O mesmo processo eu comecei fazendo aqui, ó. A minha amostra principal vai começar em 1, certo? Então, meu X vai ser o quê? Vai ser o DADOS, AN AN que é 1, né? Da coluna 1 até o NE, que é a entrada que eu decidi definir lá, correto? Certo ou não? E meu TARGET vai ser o quê? Vai ser igual aos dados. Vai ser igual aos dados. AN coluna 4, lá no caso. Eu fiz assim, ou pode colocar aqui. SIZE DADOS 2, tá? Vai lá mesmo, ó. Assim que você mexer aí em cima, já atua ele aqui pra você, automático. Então, ó, X e TARGET, beleza? Agora eu vou começar a fazer esse aqui, ó. Então, o mesmo, ó. Y0 O que vai ter o Y0? Vai ser a entrada desde quem? Desde o W1, certo? Y0 tá aqui, ó. Esses dois aqui são esses dois aqui, ó. Tá? Eu tenho que passar eles pra função de ativação. Então FOR 1 até o número de neurônio da camada 1, correto? Certo? N1, tá? Aqui vai ser de Y, né? Vou colocar aqui, ó. Y0 e vai fazer o quê? Vai de 1 dividido por 1, mais o exponencial de menos 1, que multiplica quem? Y0 e, ó. Se eu mando rodar, vou colocar um parênteses aqui, vamos ver. Vou fazer igual, ó. Aí, ó. Y0 tá aqui, ó. Depois passou pra rede neural. Saindo daqui, ó, eu vou ter o Y1. O que vai ser o Y1? Vai ser o menos 1, certo? Multiplicado por quem? Tá? Não, desculpa. Vai ser o Y1. Aqui vai ser o Y0. O que saiu aqui, certo? Multiplicado pelo W2, ó. Roda. Então tem, ó. Y1 e Y2, ó. Y1, né? Desculpa. Y0 e Y1. E Y1. Eu tenho que fazer o mesmo processo. Se eu pegar isso aqui, ó. O que eu tenho agora no N2, ó. Aqui agora vai ser 1. E aqui vai ser 1. Igualzinha, mudou nada. Y0 e Y1. Então saiu, né, ó. Saiu esse neurônio, saiu do outro, vai pra última camada agora, que nós chamamos de YS, né, de saída. O que vai ser o YS? Menos 1. E Y1. Multiplicado por quem? Por W3, que é a última camadinha que eu tenho aqui, ó. Tem que sair só um número aqui agora, ó. YS, ó. Tá? E ela tem que passar também pela função de ativação, ó. Beleza? Vai rodar. E com esse. Show! O que que eu faço agora na brincadeira aqui? Eu, pra facilitar pra mim aqui, o que que eu vou fazer? Também não precisa da multiplicação direta, de X, do tal. Eu vou fazer bem com o backup aqui, eu vou chamar de Y1 backup. Por que que eu vou fazer isso? Só pra mim salvar esse cara aqui, ó. Me ter ele guardado, que eu vou usar ele depois Vou deixar só pra me salvar esse cara aqui, ó. Certo? Só tô adicionando aqui, ó, YS. Não precisa, que é só, aqui eu vou usar, cadê o Y1 backup? Y1 zero. Essa aqui é a entrada do YS, ó. Então, ó, aqui eu vou poder fazer isso, né. Vou chamar o Y1 aqui. YS backup. Que é a entrada, né. Ou fazer melhor, né. Vou fazer um X aqui, que são entradas, correto? X, pra receber isso aqui. É só pra mim guardar esses dados aqui. Eu vou precisar usar eles, tá. Ó. Não precisava fazer isso, tá pessoal. Tô fazendo só pra facilitar a minha vida, tá. O X eu não preciso fazer isso. Esse aqui tá salvo, né. O da 1 também. E esse tá salvo da segunda, beleza. Então eu queria salvar os dois, beleza. O que que eu vou fazer aqui agora? Ó, a derivada. Certo? Vou fazer a derivada desses caras aí. Como é que vai ficar a derivada? A primeira, que é a mais tranquila, né, ó. A derivada vai ser o quê? YS que multiplica 1 menos o quê? YS, correto? Só que aqui, eu tenho que lembrar, acho que não é elevado ao quadrado, não. Não. Isso aqui sai isso aqui mesmo, ó. Tá? Essa é a derivada do YS. Fácil de fazer, ó. A do Y, cadê? Y1? Cadê o Y2 aqui? Ah, não. A do Y1 vai ser aqui, ó. Y1 derivada. O que que eu vou ter que fazer pra calcular aí, né, ó. Vou gerar ela vazia aqui. É só fazer o quê? For i, vai o quê? De 1 até o número de neurônios da camada 2, no caso. É 1, né, e 2. Vou fazer lá, ó. YS. Não, Y1 derivada. I. Vai receber quem? Vai receber i. Vai receber Y1. I. Multiplicado por 1 menos Y1. I, ó. Show de bola ou não? Vai dar rodada, ó. Vou ter meu YS derivada do Y1 derivada aqui, ó. Minha derivada já, ó. E o último, não menos importante, é o Y0, né, ó. Y0. Y0. 0. 0. E aqui vai ser 1. YS derivada. Y1 derivada. Y2 derivada. Quatro. Não, não é Y0 derivada. Tá? Beleza. Tudo derivado, tudo o que eu preciso para fazer o treinamento. Calcular o que é agora? Os? Deltas. Meu primeiro delta, D0. Quem vai ser o D0? Vai ser o TAT menos YS. Pessoal. Quem vai ser o meu D1, né? Não chamei D1, não. Chamei de delta 1, né, ó. Meu delta 1, o que vai ser? Vai ser o D0 que eu tenho. O que é D0, né? D0 vezes o quê? Vezes o meu... A última camada que eu tenho aqui que é meu W3, não é isso, ó. Então, ó, W3. W3... Aspa, ó. Ó, então eu tenho aqui B0 e D1. Beleza? Só que eu tenho um B1 aqui. O que o B1 aqui deu? Viu que eu tenho três números? Esse W3, ele tem o quê? O meu... Ô, gente. W3, W3, não, W... Eu tenho meu pai, esse aqui. Tá vendo, ó. Esse baixo eu tenho que arrancar ele fora. Como é que você vai arrancar ele fora? Você vai fazer assim, ó. Vai começar do 2, né. Até onde? Até o size. W3. 1. Ó. Então, ó. W3 agora, ó. W3, W3. D1, né? D1, ó. Então eu arranquei, quando eu dou esse comando aqui, ó. Eu arranco a... Aqui, ó. W3, W3, gente. E... O comando aqui, ó. O comando, ctrl V. Tá vendo que eu tiro esse de cima, tá vendo esse comando aqui, ó. Eu começo pegando a segunda linha até na última que eu tenho. Esse comando é pra isso, ele pega a segunda linha até na última que eu tenho pra estar salvando aí. Tá ok? Beleza. Criei o meu W1. Eu tenho que criar quem? O D2 agora, né. O D2 que eu enjoadi, que eu falei pra vocês. Tem que fazer aquela multiplicação invertida. O que vai ser o D2? Vai ser o D1 multiplicado pelo quem? Eu preciso do W2, não é isso? W1, né. W2, ó. W2. Eu não posso pegar essa linha, certo? Eu tenho que fazer o mesmo comando que eu fiz aquele lá. O que vai ser o meu W2 aqui? Eu vou pegar a cor da linha 2. Size. W2. 1. Ó. Só que eu tenho que fazer aqui obrigatoriamente a transposta, tá? Ó. Então agora eu tenho meu D2, ó. Já tô no finalzinho lá, tá vendo? É D2 só, eu passei o início e o final. Pera aí. Cara, o que deve ser essa última aqui? O que é que tá acerto? O D1 vale quanto? Esse D2 dele onde que ele tá, aqui? É a última aqui, não? Não, pegou alguma coisa errada aqui. Pera aí. W2. É isso aqui. Esse comando aqui tá errado, ó. Esse comando aqui. Esse comando tinha que sair dois números aqui pra mim. Sem só 1. Então size 1 W2 size 1. O que que seu errado esse comando aqui, gente? Da linha 2. Ah, não. Esse aqui não é... Esse é matriz, foi mal. Tem que colocar aqui, ó, todas as colunas, quer ver? Aí foi mal, tá? Esse é matriz. Matriz do comando é um pouquinho diferente. Vou colocar os dois pontinhos, tá? Então D0. D1. D2. D7. Isso é 2, 2 e 2. São dois neurônulos. Se eu mudasse aqui pra 3 neurônulos da primeira camada, 3, ó. Tem que ser o quê, ó? D0, D1, D2. Aí tem que ter 3, tá vendo? Eu mudei pra 3, tá vendo? Tenho 3 na camada 1, 3, ó. Depois eu tenho só 1 que eu não decoloquei, certo? Se não isso tá funcionando, tá? Se eu passar aqui pra 10, ó. Se eu deixo tudo automático assim, porque... Você faz uma vez só, tá? D0, D1 e D2. Então eu bote pra 10 aí, tá vendo? Nós vamos deixar tudo 2 e 2 pra todo mundo ficar feliz. Beleza. Então tem que fazer o quê agora? O treinamento. Treinamento. Como é que vai ficar esse treinamento, ó? Vamos começar pelo nosso W3, que é o último lá, certo? O que o W3 tem que fazer? Pegar a taxa, vezes o YS derivada, vezes, quem mais? Vezes o delta 0, né? O D0, não é isso? Vezes quem mais? Vezes... Não solvei esse aqui? Eu resolvi. Eu não solvei esse aqui à toa, não, pessoal. Também esse aqui, ó. Cadê? Em cima, ó. Lembra que eu solvei isso aqui? O YSX, ó. Eu preciso dele, senão as entradas, tá vendo? Então, vou colocar isso aqui, ó. YSX, ó. W, o quê? W3D. Aqui, ó. Para fazer isso tudo aqui que ele fez, eu tenho que fazer aqui a transposta dele, ó. Tá? Porque tem que ficar assim, ó. W3D tem que ser igual W3, tá vendo? Tem que estar na mesma posição. Por que tem que estar na mesma posição? Porque nós vamos fazer a aprendizagem aqui agora, ó. O W3 recebe o W3, mais quem? Mais o W3D, ó. Certo? Vou dar, ó. A primeira camada foi treinada. Só isso aqui, ó. Treinei a primeira camada. De lá, né? A última camada. Vou treinar agora a W2. Entendeu? A variação. Vou pegar a mesma coisa, ó. Vou pegar isso aqui tudo, ó. O N, tá? N vez quem? Vez a derivada. Então, YS, o quê? 1D, não é, ó? 1D, não, desculpa. É 1D. É W1D, derivada. Então, ó. Eu fiz o contrário. Quem foi, né? Ele disse que era da ordem bonitinha, né? Porque esse cara é de cá, né? Não é, ou não? Não fiz fora de ordem. Porque aqui, ó. A última é a 1, tá vendo, ó? É a 1. Tá certo, é a 1 mesmo, né? É a 1. Não, eu não fiz isso, não. Eu tive que ficar na ordem bonitinha. Esse aqui é a 1 mesmo, ó. Como é que vai ficar na minha 1 aqui? Vai ficar o YS. 1 derivada, né? Ó. Vez quem? Vez Y derivada. Está faltando alguém aqui. Está faltando alguém aqui. Vez o delta. D1, correto? Só ver como é que vai dar o resultado aqui. Tem que ficar dois números aqui. Não ficou, não? Y1 derivada. D1. Ah, tá. Isso aí é VT1 aqui, ó. VT é você, né? Então, ó. W2D. Aqui, ó. Tirei esses dois números. Só que acontece, esse cara aqui precisa da entrada dele, certo? A entrada você vai jogar radical. O pessoal vê aí também. Que foi a Y1, cadê? Y1X, ó. Esse cara aqui, ó. Y1X. Vez esse cara aqui, ó. Hã?